# WebSocketê³¼ Three.jsë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ì±„íŒ… ë° 3D ë©€í‹°í”Œë ˆì´ì–´ ê²Œì„ ë¶„ì„

-----

# WebSockeConfig í´ë˜ìŠ¤ ë¶„ì„


```java
package com.example.demo.config;

import com.example.demo.handler.ChatWebSocketHandler;
import com.example.demo.handler.GameWebSocketHandler;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.socket.config.annotation.EnableWebSocket;
import org.springframework.web.socket.config.annotation.WebSocketConfigurer;
import org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;

@Configuration
@EnableWebSocket
public class WebSocketConfig implements WebSocketConfigurer {

    @Override
    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {
        registry.addHandler(new ChatWebSocketHandler(), "/chat")
                .setAllowedOrigins("*");
        registry.addHandler(new GameWebSocketHandler(), "/game")
                .setAllowedOrigins("*");
    }
}
```
## 1. í´ë˜ìŠ¤ ê°œìš”ìš”

### ì£¼ìš” ì–´ë…¸í…Œì´ì…˜ê³¼ ì¸í„°í˜ì´ìŠ¤

- `@Configuration`: í•´ë‹¹ í´ë˜ìŠ¤ê°€ Spring ì„¤ì • í´ë˜ìŠ¤ì„ì„ ë‚˜íƒ€ë‚¸ë‹¤.
- `@EnableWebSocket`: Springì—ì„œ WebSocketì„ ì‚¬ìš©ê°€ëŠ¥í•˜ê²Œ ì„¤ì •í•œë‹¤.
- `WebSocketConfigurer`: WebSocket ì„¤ì •ì„ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤.

### í•¸ë“¤ëŸ¬ ë“±ë¡ ë©”ì„œë“œ

- ```
  registerWebSocketHandlers
  ```

  : WebSocket í•¸ë“¤ëŸ¬ë¥¼ ë“±ë¡í•˜ëŠ” ë©”ì„œë“œì´ë‹¤.

  - `/chat` ì—”ë“œí¬ì¸íŠ¸ì— ChatWebSocketHandler ë“±ë¡.
  - `/game` ì—”ë“œí¬ì¸íŠ¸ì— GameWebSocketHandler ë“±ë¡.
  - `setAllowedOrigins("*")`ë¡œ ëª¨ë“  ë„ë©”ì¸ì—ì„œì˜ ì ‘ê·¼ì„ í—ˆìš©í•œë‹¤.

### ì›¹ì†Œì¼“ ì—”ë“œí¬ì¸íŠ¸

1. ì±„íŒ…ìš© ì—”ë“œí¬ì¸íŠ¸
   - URL: `ws://localhost:8080/chat`
   - í•¸ë“¤ëŸ¬: ChatWebSocketHandler
   - ìš©ë„: ì±„íŒ… ë©”ì‹œì§€ ì²˜ë¦¬
2. ê²Œì„ìš© ì—”ë“œí¬ì¸íŠ¸
   - URL: `ws://localhost:8080/game`
   - í•¸ë“¤ëŸ¬: GameWebSocketHandler
   - ìš©ë„: ê²Œì„ ì˜¤ë¸Œì íŠ¸ ìœ„ì¹˜ ë™ê¸°í™”

### CORS ì„¤ì •

- ```
  setAllowedOrigins("*")
  ```

  - ëª¨ë“  ì¶œì²˜(Origin)ì—ì„œì˜ WebSocket ì—°ê²°ì„ í—ˆìš©
  - ê°œë°œ í™˜ê²½ì—ì„œëŠ” í¸ë¦¬í•˜ë‚˜, ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ë³´ì•ˆì„ ìœ„í•´ íŠ¹ì • ë„ë©”ì¸ë§Œ í—ˆìš©í•˜ë„ë¡ ìˆ˜ì •ì´ í•„ìš”

### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. ìš´ì˜ í™˜ê²½ CORS ì„¤ì •
```java
registry.addHandler(new ChatWebSocketHandler(), "/chat")
        .setAllowedOrigins("https://your-domain.com");
```

1. ì¸ì¦ ì²˜ë¦¬ ì¶”ê°€

```java
registry.addHandler(new ChatWebSocketHandler(), "/chat")
        .setAllowedOrigins("*")
        .addInterceptors(new HttpSessionHandshakeInterceptor());
```

### ì›¹ì†Œì¼“ ì—°ê²° íë¦„

1. í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ìš”ì²­
2. í•¸ë“¤ëŸ¬ ë§¤í•‘
3. í•´ë‹¹ í•¸ë“¤ëŸ¬ì—ì„œ ë©”ì‹œì§€ ì²˜ë¦¬
4. í´ë¼ì´ì–¸íŠ¸ë¡œ ì‘ë‹µ ì „ì†¡

-----

# ChatWebSocketHandler í´ë˜ìŠ¤ ë¶„ì„

```java
package com.example.demo.handler;

import com.fasterxml.jackson.databind.JsonNode;
import org.springframework.stereotype.Component;
import org.springframework.web.socket.*;
import org.springframework.web.socket.handler.TextWebSocketHandler;

import com.fasterxml.jackson.databind.ObjectMapper;

import java.text.SimpleDateFormat;
import java.util.List;
import java.util.concurrent.CopyOnWriteArrayList;

@Component
public class ChatWebSocketHandler extends TextWebSocketHandler {
    private static final List<WebSocketSession> sessions = new CopyOnWriteArrayList<>();
    private static final ObjectMapper objectMapper = new ObjectMapper();
    private static final SimpleDateFormat dateFormat = new SimpleDateFormat("HH:mm:ss");

    @Override
    public void afterConnectionEstablished(WebSocketSession session) throws Exception {
        sessions.add(session);
        System.out.println("ìƒˆë¡œìš´ í´ë¼ì´ì–¸íŠ¸ ì ‘ì†: " + session.getId());
    }

    @Override
    protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception {
        // JSON ë©”ì‹œì§€ íŒŒì‹±
        JsonNode jsonNode = objectMapper.readTree(message.getPayload());
        String messageText = jsonNode.get("message").asText();
        String time = jsonNode.get("time").asText();

        // ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ë“¤ì—ê²Œ ë©”ì‹œì§€ ì „ë‹¬
        for (WebSocketSession connectedSession : sessions) {
            if (!session.getId().equals(connectedSession.getId())) {
                String formattedMessage = String.format("[%s] %s: %s",
                        time,
                        session.getId().substring(0, 8), // ID ì• 8ìë¦¬ë§Œ ì‚¬ìš©
                        messageText
                );
                connectedSession.sendMessage(new TextMessage(formattedMessage));
            }
        }
    }
    @Override
    public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {
        sessions.remove(session);
        System.out.println("í´ë¼ì´ì–¸íŠ¸ ì ‘ì† í•´ì œ: " + session.getId());
    }

    @Override
    public void handleTransportError(WebSocketSession session, Throwable exception) throws Exception {
        System.out.println("ì „ì†¡ ì—ëŸ¬ ë°œìƒ: " + session.getId() + ", ì—ëŸ¬: " + exception.getMessage());
    }

    private static class ChatMessage {
        private String sender;
        private String message;
        private String time;

        public ChatMessage(String sender, String message, String time) {
            this.sender = sender;
            this.message = message;
            this.time = time;
        }

        public String getSender() {
            return sender;
        }

        public String getMessage() {
            return message;
        }

        public String getTime() {
            return time;
        }
    }
}
```

## 1. í´ë˜ìŠ¤ ê°œìš”
```java
@Component
public class ChatWebSocketHandler extends TextWebSocketHandler {
    private static final List<WebSocketSession> sessions = new CopyOnWriteArrayList<>();
    private static final ObjectMapper objectMapper = new ObjectMapper();
    private static final SimpleDateFormat dateFormat = new SimpleDateFormat("HH:mm:ss");
}
```

### ì£¼ìš” êµ¬ì„± ìš”ì†Œ
- `@Component`: Spring ì»´í¬ë„ŒíŠ¸ë¡œ ë“±ë¡í•˜ì—¬ ë¹ˆìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.
- `TextWebSocketHandler`: í…ìŠ¤íŠ¸ ê¸°ë°˜ WebSocket ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¸ë“¤ëŸ¬ë¥¼ ìƒì†í•œë‹¤.
- `CopyOnWriteArrayList`: ìŠ¤ë ˆë“œ ì•ˆì „í•œ ë¦¬ìŠ¤íŠ¸ë¡œ ë™ì‹œì„± ì²˜ë¦¬ë¥¼ í•œë‹¤.
- `ObjectMapper`: JSON íŒŒì‹±ì„ ìœ„í•œ Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°ì²´ì´ë‹¤.
- `SimpleDateFormat`: ì‹œê°„ í¬ë§·íŒ…ì„ ìœ„í•œ ê°ì²´ì´ë‹¤.

## 2. ë©”ì„œë“œ ë¶„ì„

### ì—°ê²° ì„¤ì •
```java
@Override
public void afterConnectionEstablished(WebSocketSession session) throws Exception {
    sessions.add(session);
    System.out.println("ìƒˆë¡œìš´ í´ë¼ì´ì–¸íŠ¸ ì ‘ì†: " + session.getId());
}
```

- ìƒˆë¡œìš´ WebSocket ì—°ê²°ì´ ì„¤ì •ë  ë•Œ í˜¸ì¶œëœë‹¤.
- ì„¸ì…˜ì„ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ê³  ë¡œê·¸ë¥¼ ì¶œë ¥í•œë‹¤.

### ë©”ì‹œì§€ ì²˜ë¦¬
```java
@Override
protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception {
    JsonNode jsonNode = objectMapper.readTree(message.getPayload());
    String messageText = jsonNode.get("message").asText();
    String time = jsonNode.get("time").asText();

    for (WebSocketSession connectedSession : sessions) {
        if (!session.getId().equals(connectedSession.getId())) {
            String formattedMessage = String.format("[%s] %s: %s",
                    time,
                    session.getId().substring(0, 8),
                    messageText
            );
            connectedSession.sendMessage(new TextMessage(formattedMessage));
        }
    }
}
```

- í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë©”ì‹œì§€ë¥¼ ë°›ì•„ ì²˜ë¦¬í•œë‹¤.
- JSON í˜•ì‹ì˜ ë©”ì‹œì§€ë¥¼ íŒŒì‹±í•œë‹¤.
- ë©”ì‹œì§€ë¥¼ í¬ë§·íŒ…í•˜ì—¬ ë‹¤ë¥¸ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡í•œë‹¤.
- ë°œì‹ ìëŠ” ì œì™¸í•˜ê³  ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•œë‹¤.

### ì—°ê²° ì¢…ë£Œ
```java
@Override
public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {
    sessions.remove(session);
    System.out.println("í´ë¼ì´ì–¸íŠ¸ ì ‘ì† í•´ì œ: " + session.getId());
}
```

- WebSocket ì—°ê²°ì´ ì¢…ë£Œë  ë•Œ í˜¸ì¶œëœë‹¤.
- ì„¸ì…˜ì„ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì œê±°í•˜ê³  ë¡œê·¸ë¥¼ ì¶œë ¥í•œë‹¤.

### ì—ëŸ¬ ì²˜ë¦¬
```java
@Override
public void handleTransportError(WebSocketSession session, Throwable exception) throws Exception {
    System.out.println("ì „ì†¡ ì—ëŸ¬ ë°œìƒ: " + session.getId() + ", ì—ëŸ¬: " + exception.getMessage());
}
```

- WebSocket í†µì‹  ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí•  ë•Œ í˜¸ì¶œëœë‹¤.
- ì—ëŸ¬ ì •ë³´ë¥¼ ë¡œê·¸ë¡œ ì¶œë ¥í•œë‹¤.

## 3. ë‚´ë¶€ í´ë˜ìŠ¤ - ChatMessage

```java
private static class ChatMessage {
    private String sender;
    private String message;
    private String time;

    // ìƒì„±ì ë° getter ë©”ì„œë“œ
}
```

- ì±„íŒ… ë©”ì‹œì§€ì˜ ë°ì´í„° êµ¬ì¡°ë¥¼ ì •ì˜í•œë‹¤.
- ë°œì‹ ì, ë©”ì‹œì§€ ë‚´ìš©, ì‹œê°„ ì •ë³´ë¥¼ í¬í•¨í•œë‹¤.

## 4. ì£¼ìš” íŠ¹ì§•

1. **ë™ì‹œì„± ì²˜ë¦¬**
   - `CopyOnWriteArrayList`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤ë ˆë“œ ì•ˆì „ì„± ë³´ì¥
   - ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ì˜ ë™ì‹œ ì ‘ì† ì²˜ë¦¬ ê°€ëŠ¥
2. **ë©”ì‹œì§€ í¬ë§·íŒ…**
   - ì‹œê°„ ì •ë³´ í¬í•¨
   - ë°œì‹ ì ID ì¼ë¶€ë§Œ í‘œì‹œí•˜ì—¬ í”„ë¼ì´ë²„ì‹œ ë³´í˜¸
3. **ë¸Œë¡œë“œìºìŠ¤íŒ…**
   - ë°œì‹ ìë¥¼ ì œì™¸í•œ ëª¨ë“  ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë©”ì‹œì§€ ì „ë‹¬
   - 1:N í†µì‹  êµ¬í˜„
4. **ì—ëŸ¬ ì²˜ë¦¬**
   - ì—°ê²°, ë©”ì‹œì§€ ì „ì†¡, ì¢…ë£Œ ì‹œì˜ ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬
   - ë¡œê¹…ì„ í†µí•œ ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥

## 5. ì‚¬ìš© ì˜ˆì‹œ

```JSON
// í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì „ì†¡í•˜ëŠ” JSON í˜•ì‹
{
    "message": "ì•ˆë…•í•˜ì„¸ìš”",
    "time": "12:34:56"
}

// ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ë“¤ì´ ë°›ëŠ” ë©”ì‹œì§€ í˜•ì‹
"[12:34:56] ab12cd34: ì•ˆë…•í•˜ì„¸ìš”"
```

-----

# GameWebSocketHandler í´ë˜ìŠ¤ ë¶„ì„

```java
package com.example.demo.handler;

import org.springframework.stereotype.Component;
import org.springframework.web.socket.*;
import org.springframework.web.socket.handler.TextWebSocketHandler;

import java.util.List;
import java.util.concurrent.CopyOnWriteArrayList;

@Component
public class GameWebSocketHandler extends TextWebSocketHandler {
    private static final List<WebSocketSession> sessions = new CopyOnWriteArrayList<>();

    @Override
    public void afterConnectionEstablished(WebSocketSession session) throws Exception {
        sessions.add(session);
    }

    @Override
    protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception {
        String payload = message.getPayload();
        for (WebSocketSession s : sessions) {
            if (s.isOpen() && !s.getId().equals(session.getId())) {
                s.sendMessage(new TextMessage(payload));
            }
        }
    }

    @Override
    public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {
        sessions.remove(session);
        String disconnectMessage = String.format("{\"type\":\"disconnect\",\"id\":\"%s\"}", session.getId());
        for (WebSocketSession s : sessions) {
            if (s.isOpen()) {
                s.sendMessage(new TextMessage(disconnectMessage));
            }
        }
    }
}
```

## 1. í´ë˜ìŠ¤ ê°œìš”

```java
@Component
public class GameWebSocketHandler extends TextWebSocketHandler {
    private static final List<WebSocketSession> sessions = new CopyOnWriteArrayList<>();
}
```

### ì£¼ìš” êµ¬ì„± ìš”ì†Œ
- `@Component`: Spring ì»´í¬ë„ŒíŠ¸ë¡œ ë“±ë¡í•˜ì—¬ ë¹ˆìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.
- `TextWebSocketHandler`: í…ìŠ¤íŠ¸ ê¸°ë°˜ WebSocket ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¸ë“¤ëŸ¬ë¥¼ ìƒì†í•œë‹¤.
- `CopyOnWriteArrayList`: ìŠ¤ë ˆë“œ ì•ˆì „í•œ ë¦¬ìŠ¤íŠ¸ë¡œ ì„¸ì…˜ì„ ê´€ë¦¬í•œë‹¤.

## 2. ë©”ì„œë“œ ë¶„ì„

### 2.1 ì—°ê²° ì„¤ì •
```java
@Override
public void afterConnectionEstablished(WebSocketSession session) throws Exception {
    sessions.add(session);
}
```

- ìƒˆë¡œìš´ ê²Œì„ í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ì†í•  ë•Œ í˜¸ì¶œëœë‹¤.
- ì ‘ì†í•œ ì„¸ì…˜ì„ sessions ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•œë‹¤.
- ChatWebSocketHandlerì™€ ë‹¬ë¦¬ ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ì§€ ì•ŠëŠ”ë‹¤.

### 2.2 ë©”ì‹œì§€ ì²˜ë¦¬
```java
@Override
protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception {
    String payload = message.getPayload();
    for (WebSocketSession s : sessions) {
        if (s.isOpen() && !s.getId().equals(session.getId())) {
            s.sendMessage(new TextMessage(payload));
        }
    }
}
```

- í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ ê²Œì„ ë°ì´í„°(ìœ„ì¹˜ ì •ë³´ ë“±)ë¥¼ ì²˜ë¦¬í•œë‹¤.
- ë°›ì€ ë©”ì‹œì§€ë¥¼ ê·¸ëŒ€ë¡œ ë‹¤ë¥¸ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•œë‹¤.
- ë©”ì‹œì§€ ë°œì‹ ìë¥¼ ì œì™¸í•œ ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ì—ê²Œë§Œ ì „ì†¡í•œë‹¤.
- JSON íŒŒì‹± ì—†ì´ raw í˜ì´ë¡œë“œë¥¼ ê·¸ëŒ€ë¡œ ì „ë‹¬í•œë‹¤.

### 2.3 ì—°ê²° ì¢…ë£Œ
```java
@Override
public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {
    sessions.remove(session);
    String disconnectMessage = String.format("{\"type\":\"disconnect\",\"id\":\"%s\"}", session.getId());
    for (WebSocketSession s : sessions) {
        if (s.isOpen()) {
            s.sendMessage(new TextMessage(disconnectMessage));
        }
    }
}
```

- í´ë¼ì´ì–¸íŠ¸ ì—°ê²°ì´ ì¢…ë£Œë  ë•Œ í˜¸ì¶œëœë‹¤.
- ì„¸ì…˜ì„ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì œê±°í•œë‹¤.
- ì—°ê²° ì¢…ë£Œ ë©”ì‹œì§€ë¥¼ ë‹¤ë¥¸ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡í•œë‹¤.
- ì¢…ë£Œ ë©”ì‹œì§€ëŠ” JSON í˜•ì‹ìœ¼ë¡œ ì „ì†¡ëœë‹¤.

## 3. ì£¼ìš” íŠ¹ì§•

### 3.1 ChatWebSocketHandlerì™€ì˜ ì°¨ì´ì 
1. **ë©”ì‹œì§€ ì²˜ë¦¬ ë°©ì‹**
   - ë©”ì‹œì§€ íŒŒì‹±ì„ í•˜ì§€ ì•Šê³  raw ë°ì´í„°ë¥¼ ì „ë‹¬
   - í¬ë§·íŒ…ì´ë‚˜ ê°€ê³µ ì—†ì´ ì›ë³¸ ê·¸ëŒ€ë¡œ ì „ì†¡
2. **ë¡œê¹…**
   - ë³„ë„ì˜ ë¡œê·¸ ì¶œë ¥ì´ ì—†ì–´ ë” ê°€ë²¼ìš´ ì²˜ë¦¬
   - ë””ë²„ê¹…ì´ í•„ìš”í•œ ê²½ìš° ë¡œê·¸ ì¶”ê°€ í•„ìš”
3. **ì—°ê²° ì¢…ë£Œ ì²˜ë¦¬**
   - ëª…ì‹œì ì¸ ì—°ê²° ì¢…ë£Œ ë©”ì‹œì§€ ì „ì†¡
   - ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ë“¤ì´ í‡´ì¥í•œ í”Œë ˆì´ì–´ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•¨

### 3.2 ë™ì‘ ë°©ì‹
```JavaScript
// í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì „ì†¡í•˜ëŠ” ìœ„ì¹˜ ë°ì´í„° ì˜ˆì‹œ
{
    "id": "player123",
    "position": {
        "x": 10,
        "z": 20
    }
}

// ì—°ê²° ì¢…ë£Œ ì‹œ ì „ì†¡ë˜ëŠ” ë©”ì‹œì§€
{
    "type": "disconnect",
    "id": "session123"
}
```

## 4. ê°œì„  ê°€ëŠ¥í•œ ë¶€ë¶„

### 4.1 ì—ëŸ¬ ì²˜ë¦¬
```java
@Override
public void handleTransportError(WebSocketSession session, Throwable exception) {
    // ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€ í•„ìš”
}
```

### 4.2 ì—°ê²° ìƒíƒœ ëª¨ë‹ˆí„°ë§
```java
private void logSessionStatus() {
    System.out.println("í˜„ì¬ ì—°ê²°ëœ ê²Œì„ í´ë¼ì´ì–¸íŠ¸ ìˆ˜: " + sessions.size());
}
```

### 4.3 ë©”ì‹œì§€ ìœ íš¨ì„± ê²€ì‚¬
```java
private boolean isValidGameMessage(String payload) {
    try {
        // JSON í˜•ì‹ ê²€ì¦
        // í•„ìˆ˜ í•„ë“œ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
        return true;
    } catch (Exception e) {
        return false;
    }
}
```

## 5. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **ë©”ì‹œì§€ ê²€ì¦**
   - í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ ë°ì´í„°ì˜ ìœ íš¨ì„± ê²€ì‚¬ í•„ìš”
   - ì˜ëª»ëœ í˜•ì‹ì˜ ë©”ì‹œì§€ í•„í„°ë§
2. **ì„¸ì…˜ ê´€ë¦¬**
   - ë¹„ì •ìƒì ì¸ ì—°ê²° ì‹œë„ ê°ì§€
   - ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì •
3. **ê¶Œí•œ ê²€ì‚¬**
   - ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
   - ê²Œì„ ë£¸ë³„ ì ‘ê·¼ ê¶Œí•œ ê´€ë¦¬


-----

# Three.js ê²Œì„ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ë¶„ì„

```JavaScript
import * as THREE from './node_modules/three/build/three.module.js';

const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('threejs-canvas') });
renderer.setSize(window.innerWidth, window.innerHeight);

const geometry = new THREE.BoxGeometry();
const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const player = new THREE.Mesh(geometry, material);
scene.add(player);

const otherPlayers = {};

const floorGeometry = new THREE.PlaneGeometry(20, 20);
const floorMaterial = new THREE.MeshBasicMaterial({ color: 0x999999, side: THREE.DoubleSide });
const floor = new THREE.Mesh(floorGeometry, floorMaterial);
floor.rotation.x = Math.PI / 2;
scene.add(floor);

camera.position.z = 5;
camera.position.y = 2;

let speed = { x: 0, z: 0 };

const gameSocket = new WebSocket('ws://localhost:8080/game');

gameSocket.onopen = () => {
    console.log('Connected to WebSocket server');
};

gameSocket.onmessage = (event) => {
    const data = JSON.parse(event.data);

    if (!otherPlayers[data.id]) {
        const otherPlayerGeometry = new THREE.BoxGeometry();
        const otherPlayerMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
        const otherPlayer = new THREE.Mesh(otherPlayerGeometry, otherPlayerMaterial);
        scene.add(otherPlayer);
        otherPlayers[data.id] = otherPlayer;
    }
    otherPlayers[data.id].position.x = data.position.x;
    otherPlayers[data.id].position.z = data.position.z;
};

gameSocket.onclose = () => {
    console.log('Disconnected from WebSocket server');
};

// í‚¤ ì…ë ¥ ì´ë²¤íŠ¸ ì²˜ë¦¬
window.addEventListener('keydown', (event) => {
    if (event.key === 'ArrowUp') speed.z = -0.1;
    if (event.key === 'ArrowDown') speed.z = 0.1;
    if (event.key === 'ArrowLeft') speed.x = -0.1;
    if (event.key === 'ArrowRight') speed.x = 0.1;
});

window.addEventListener('keyup', () => {
    speed.x = 0;
    speed.z = 0;
});

function animate() {
    requestAnimationFrame(animate);

    player.position.x += speed.x;
    player.position.z += speed.z;

    gameSocket.send(JSON.stringify({
        id: gameSocket.id,
        position: { x: player.position.x, z: player.position.z }
    }));

    renderer.render(scene, camera);
}
animate();
```

## 1. Three.js ì´ˆê¸°í™” ë° ì¥ë©´ ì„¤ì •

```JavaScript
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('threejs-canvas') });
renderer.setSize(window.innerWidth, window.innerHeight);
```

### ì„¤ì • ìƒì„¸
- **Scene**: 3D ê°ì²´ë“¤ì´ ë°°ì¹˜ë˜ëŠ” ì»¨í…Œì´ë„ˆ
- Camera
  :
  - FOV(ì‹œì•¼ê°): 75ë„
  - ì¢…íš¡ë¹„: í™”ë©´ í¬ê¸°ì— ë§ì¶¤
  - ê·¼í‰ë©´: 0.1
  - ì›í‰ë©´: 1000
- **Renderer**: ìº”ë²„ìŠ¤ì— 3D ì¥ë©´ì„ ë Œë”ë§

## 2. ê²Œì„ ì˜¤ë¸Œì íŠ¸ ìƒì„±

```JavaScript
// í”Œë ˆì´ì–´ ìƒì„±
const geometry = new THREE.BoxGeometry();
const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const player = new THREE.Mesh(geometry, material);
scene.add(player);

// ë°”ë‹¥ í‰ë©´ ìƒì„±
const floorGeometry = new THREE.PlaneGeometry(20, 20);
const floorMaterial = new THREE.MeshBasicMaterial({ 
    color: 0x999999, 
    side: THREE.DoubleSide 
});
const floor = new THREE.Mesh(floorGeometry, floorMaterial);
floor.rotation.x = Math.PI / 2;
scene.add(floor);
```

### ì˜¤ë¸Œì íŠ¸ ìƒì„¸
- **í”Œë ˆì´ì–´**: ì´ˆë¡ìƒ‰(0x00ff00) íë¸Œ
- **ë°”ë‹¥**: 20x20 í¬ê¸°ì˜ íšŒìƒ‰(0x999999) í‰ë©´
- **ì¹´ë©”ë¼ ìœ„ì¹˜**: z=5, y=2ë¡œ ì„¤ì •í•˜ì—¬ ë¹„ìŠ¤ë“¬íˆ ë‚´ë ¤ë‹¤ë³´ëŠ” ì‹œì 

## 3. WebSocket í†µì‹  êµ¬í˜„

```JavaScript
const gameSocket = new WebSocket('ws://localhost:8080/game');

gameSocket.onopen = () => {
    console.log('Connected to WebSocket server');
};

gameSocket.onmessage = (event) => {
    const data = JSON.parse(event.data);

    if (!otherPlayers[data.id]) {
        const otherPlayerGeometry = new THREE.BoxGeometry();
        const otherPlayerMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
        const otherPlayer = new THREE.Mesh(otherPlayerGeometry, otherPlayerMaterial);
        scene.add(otherPlayer);
        otherPlayers[data.id] = otherPlayer;
    }
    otherPlayers[data.id].position.x = data.position.x;
    otherPlayers[data.id].position.z = data.position.z;
};
```

### WebSocket ì´ë²¤íŠ¸ ì²˜ë¦¬
1. **ì—°ê²° ì„¤ì •**
   - ì„œë²„ì™€ WebSocket ì—°ê²°
   - ì—°ê²° ì„±ê³µ ì‹œ ì½˜ì†”ì— ë¡œê·¸ ì¶œë ¥
2. **ë©”ì‹œì§€ ìˆ˜ì‹ **
   - ë‹¤ë¥¸ í”Œë ˆì´ì–´ì˜ ìœ„ì¹˜ ì •ë³´ ìˆ˜ì‹ 
   - ìƒˆë¡œìš´ í”Œë ˆì´ì–´ë©´ ë¹¨ê°„ìƒ‰(0xff0000) íë¸Œ ìƒì„±
   - ê¸°ì¡´ í”Œë ˆì´ì–´ë©´ ìœ„ì¹˜ ì—…ë°ì´íŠ¸

## 4. í”Œë ˆì´ì–´ ì…ë ¥ ì²˜ë¦¬

```JavaScript
let speed = { x: 0, z: 0 };

window.addEventListener('keydown', (event) => {
    if (event.key === 'ArrowUp') speed.z = -0.1;
    if (event.key === 'ArrowDown') speed.z = 0.1;
    if (event.key === 'ArrowLeft') speed.x = -0.1;
    if (event.key === 'ArrowRight') speed.x = 0.1;
});

window.addEventListener('keyup', () => {
    speed.x = 0;
    speed.z = 0;
});
```

### í‚¤ ì…ë ¥ ì²˜ë¦¬
- **ë°©í–¥í‚¤ ì…ë ¥**: í•´ë‹¹ ë°©í–¥ìœ¼ë¡œ ì´ë™ ì†ë„ ì„¤ì •
- **í‚¤ í•´ì œ**: ì†ë„ë¥¼ 0ìœ¼ë¡œ ì´ˆê¸°í™”
- **ì´ë™ ì†ë„**: 0.1 ë‹¨ìœ„ë¡œ ì„¤ì •

## 5. ê²Œì„ ë£¨í”„ êµ¬í˜„

```JavaScript
function animate() {
    requestAnimationFrame(animate);

    player.position.x += speed.x;
    player.position.z += speed.z;

    gameSocket.send(JSON.stringify({
        id: gameSocket.id,
        position: { x: player.position.x, z: player.position.z }
    }));

    renderer.render(scene, camera);
}
animate();
```

### ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„ ë™ì‘
1. **í”„ë ˆì„ ìš”ì²­**: requestAnimationFrameìœ¼ë¡œ ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜
2. **í”Œë ˆì´ì–´ ì´ë™**: í˜„ì¬ ì†ë„ì— ë”°ë¼ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
3. **ìœ„ì¹˜ ì „ì†¡**: WebSocketì„ í†µí•´ ì„œë²„ì— ìœ„ì¹˜ ì •ë³´ ì „ì†¡
4. **ë Œë”ë§**: ì—…ë°ì´íŠ¸ëœ ì¥ë©´ì„ í™”ë©´ì— ë Œë”ë§

## 6. ë°ì´í„° êµ¬ì¡°

```JavaScript
// ì†ë„ ê°ì²´
speed = { 
    x: 0,  // Xì¶• ì´ë™ ì†ë„
    z: 0   // Zì¶• ì´ë™ ì†ë„
}

// ìœ„ì¹˜ ë©”ì‹œì§€ í¬ë§·
{
    id: "í”Œë ˆì´ì–´ID",
    position: {
        x: 0,  // Xì¶• ìœ„ì¹˜
        z: 0   // Zì¶• ìœ„ì¹˜
    }
}
```

## 7. ìµœì í™” ê³ ë ¤ì‚¬í•­

1. **ë Œë”ë§ ì„±ëŠ¥**
   - requestAnimationFrame ì‚¬ìš©ìœ¼ë¡œ íš¨ìœ¨ì ì¸ ë Œë”ë§
   - í•„ìš”í•œ ê²½ìš°ì—ë§Œ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
2. **ë„¤íŠ¸ì›Œí¬ ìµœì í™”**
   - ìœ„ì¹˜ ë³€ê²½ ì‹œì—ë§Œ ë°ì´í„° ì „ì†¡
   - ë°ì´í„° í¬ë§· ìµœì†Œí™”
3. **ë©”ëª¨ë¦¬ ê´€ë¦¬**
   - ì—°ê²° ì¢…ë£Œëœ í”Œë ˆì´ì–´ ê°ì²´ ì œê±°
   - ë¶ˆí•„ìš”í•œ ê°ì²´ ìƒì„± ìµœì†Œí™”


-----

# index.html íŒŒì¼ ë¶„ì„

```HTML
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>hello~</title>
    <!-- Three.js CDN ì¶”ê°€ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
        }
        #chatContainer {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 5px;
            width: 300px;
        }
        #chatLog {
            width: 100%;
            height: 200px;
            overflow-y: auto;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            padding: 10px;
            background: white;
        }
        #messageInput {
            width: 80%;
            padding: 5px;
        }
        button {
            padding: 5px 15px;
        }
        #threejs-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
    </style>
</head>
<body>
<div id="chatContainer">
    <div id="chatLog"></div>
    <input type="text" id="messageInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
    <button onclick="sendMessage()">ì „ì†¡</button>
</div>
<canvas id="threejs-canvas"></canvas>

<script type="module">
    // ì±„íŒ… WebSocket ì„¤ì •
    const chatSocket = new WebSocket('ws://localhost:8080/chat');
    const chatLog = document.getElementById('chatLog');
    const messageInput = document.getElementById('messageInput');

    chatSocket.onopen = function(event) {
        appendMessage("ì‹œìŠ¤í…œ", "WebSocket ì—°ê²°ë¨", new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true }));
    };

    chatSocket.onmessage = function(event) {
        const messageElement = document.createElement('div');
        messageElement.textContent = event.data;
        chatLog.appendChild(messageElement);
        chatLog.scrollTop = chatLog.scrollHeight;
    };

    chatSocket.onclose = function(event) {
        appendMessage("ì‹œìŠ¤í…œ", "WebSocket ì—°ê²° ì¢…ë£Œ", new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true }));
    };

    chatSocket.onerror = function(error) {
        appendMessage("ì‹œìŠ¤í…œ", 'WebSocket ì—ëŸ¬: ' + error.message, new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true }));
    };

    window.sendMessage = function() {
        const message = messageInput.value;
        if (message) {
            const jsonMessage = JSON.stringify({
                sender: "ë‚˜",
                message: message,
                time: new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true })
            });
            chatSocket.send(jsonMessage);
            messageInput.value = '';
            appendMessage("ë‚˜", message, new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true }));
        }
    }

    function appendMessage(sender, message, time) {
        const messageElement = document.createElement('div');
        messageElement.textContent = `[${time}] ${sender === "ë‚˜" ? "ë‚˜" : sender}: ${message}`;
        chatLog.appendChild(messageElement);
        chatLog.scrollTop = chatLog.scrollHeight;
    }

    // Enter í‚¤ë¡œ ë©”ì‹œì§€ ì „ì†¡
    messageInput.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    });

    // Three.js ì„¤ì •
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({
        canvas: document.getElementById('threejs-canvas'),
        antialias: true
    });
    renderer.setSize(window.innerWidth, window.innerHeight);

    // ë°”ë‹¥ ì¶”ê°€
    const floorGeometry = new THREE.PlaneGeometry(20, 20);
    const floorMaterial = new THREE.MeshBasicMaterial({
        color: 0x999999,
        side: THREE.DoubleSide
    });
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = Math.PI / 2;
    scene.add(floor);

    // í”Œë ˆì´ì–´ ê°ì²´ ìƒì„±
    const geometry = new THREE.BoxGeometry();
    const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
    const player = new THREE.Mesh(geometry, material);
    scene.add(player);

    camera.position.set(0, 5, 10);
    camera.lookAt(0, 0, 0);

    // ë‹¤ë¥¸ í”Œë ˆì´ì–´ë“¤ì„ ì €ì¥í•  ê°ì²´
    let otherPlayers = {};

    // ê²Œì„ WebSocket ì„¤ì •
    const gameSocket = new WebSocket('ws://localhost:8080/game');
    let speed = { x: 0, z: 0 };
    let playerId = Math.random().toString(36).substr(2, 9);

    gameSocket.onmessage = (event) => {
        const data = JSON.parse(event.data);
        if (!otherPlayers[data.id]) {
            const otherPlayerGeometry = new THREE.BoxGeometry();
            const otherPlayerMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
            const otherPlayer = new THREE.Mesh(otherPlayerGeometry, otherPlayerMaterial);
            scene.add(otherPlayer);
            otherPlayers[data.id] = otherPlayer;
        }
        const otherPlayer = otherPlayers[data.id];
        otherPlayer.position.set(data.position.x, 0, data.position.z);
    };

    gameSocket.onclose = (event) => {
        console.log('Disconnected from WebSocket server');
        Object.values(otherPlayers).forEach(player => {
            scene.remove(player);
        });
        otherPlayers = {};
    };

    window.addEventListener('keydown', (event) => {
        switch (event.key) {
            case 'ArrowUp': speed.z = -0.1; break;
            case 'ArrowDown': speed.z = 0.1; break;
            case 'ArrowLeft': speed.x = -0.1; break;
            case 'ArrowRight': speed.x = 0.1; break;
        }
    });

    window.addEventListener('keyup', (event) => {
        speed.x = 0;
        speed.z = 0;
    });

    function animate() {
        requestAnimationFrame(animate);
        player.position.x += speed.x;
        player.position.z += speed.z;
        if (gameSocket.readyState === WebSocket.OPEN) {
            gameSocket.send(JSON.stringify({ id: playerId, position: { x: player.position.x, z: player.position.z } }));
        }
        renderer.render(scene, camera);
    }
    animate();
</script>
</body>
</html>
```

## 1. HTML êµ¬ì¡° ë° ìŠ¤íƒ€ì¼

```HTML
<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
```

### CSS ìŠ¤íƒ€ì¼ ë¶„ì„
```CSS
#chatContainer {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 100;
    /* ... */
}

#threejs-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
}
```

- ì±„íŒ…ì°½ì„ 3D í™”ë©´ ìœ„ì— ì˜¤ë²„ë ˆì´ë¡œ í‘œì‹œ
- ìº”ë²„ìŠ¤ëŠ” ì „ì²´ í™”ë©´ì„ ì°¨ì§€

## 2. WebSocket í†µì‹  êµ¬í˜„

### 2.1 ì±„íŒ… ì†Œì¼“ ì„¤ì •
```JavaScript
const chatSocket = new WebSocket('ws://localhost:8080/chat');

chatSocket.onopen = function(event) {
    appendMessage("ì‹œìŠ¤í…œ", "WebSocket ì—°ê²°ë¨", /* ... */);
};

chatSocket.onmessage = function(event) {
    const messageElement = document.createElement('div');
    messageElement.textContent = event.data;
    chatLog.appendChild(messageElement);
    chatLog.scrollTop = chatLog.scrollHeight;
};
```

- WebSocket ì—°ê²° ì„¤ì • ë° ì´ë²¤íŠ¸ ì²˜ë¦¬
- ë©”ì‹œì§€ ìˆ˜ì‹  ì‹œ ì±„íŒ…ì°½ì— í‘œì‹œ

### 2.2 ê²Œì„ ì†Œì¼“ ì„¤ì •
```JavaScript
const gameSocket = new WebSocket('ws://localhost:8080/game');
let playerId = Math.random().toString(36).substr(2, 9);

gameSocket.onmessage = (event) => {
    const data = JSON.parse(event.data);
    // ë‹¤ë¥¸ í”Œë ˆì´ì–´ ì²˜ë¦¬
};
```

- ê²Œì„ ë°ì´í„° ë™ê¸°í™”ë¥¼ ìœ„í•œ ë³„ë„ ì†Œì¼“
- ëœë¤ í”Œë ˆì´ì–´ ID ìƒì„±

## 3. Three.js 3D ë Œë”ë§

### 3.1 ê¸°ë³¸ ì„¤ì •
```JavaScript
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({
    canvas: document.getElementById('threejs-canvas'),
    antialias: true
});
```

- 3D ì”¬, ì¹´ë©”ë¼, ë Œë”ëŸ¬ ì´ˆê¸°í™”
- ì•ˆí‹°ì•¨ë¦¬ì–´ì‹± ì ìš©ìœ¼ë¡œ ë¶€ë“œëŸ¬ìš´ ë Œë”ë§

### 3.2 ê²Œì„ ì˜¤ë¸Œì íŠ¸ ìƒì„±
```JavaScript
// ë°”ë‹¥ í‰ë©´
const floorGeometry = new THREE.PlaneGeometry(20, 20);
const floor = new THREE.Mesh(floorGeometry, floorMaterial);
floor.rotation.x = Math.PI / 2;

// í”Œë ˆì´ì–´ íë¸Œ
const geometry = new THREE.BoxGeometry();
const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const player = new THREE.Mesh(geometry, material);
```

- íšŒìƒ‰ ë°”ë‹¥ í‰ë©´ ìƒì„±
- ì´ˆë¡ìƒ‰ í”Œë ˆì´ì–´ íë¸Œ ìƒì„±

## 4. ê²Œì„ ë¡œì§ êµ¬í˜„

### 4.1 í”Œë ˆì´ì–´ ì´ë™
```JavaScript
let speed = { x: 0, z: 0 };

window.addEventListener('keydown', (event) => {
    switch (event.key) {
        case 'ArrowUp': speed.z = -0.1; break;
        case 'ArrowDown': speed.z = 0.1; break;
        case 'ArrowLeft': speed.x = -0.1; break;
        case 'ArrowRight': speed.x = 0.1; break;
    }
});
```

- ë°©í–¥í‚¤ë¡œ ì´ë™ ì†ë„ ì œì–´
- xì¶•ê³¼ zì¶•ìœ¼ë¡œ ì´ë™

### 4.2 ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
```JavaScript
function animate() {
    requestAnimationFrame(animate);
    player.position.x += speed.x;
    player.position.z += speed.z;
    if (gameSocket.readyState === WebSocket.OPEN) {
        gameSocket.send(JSON.stringify({ 
            id: playerId, 
            position: { x: player.position.x, z: player.position.z } 
        }));
    }
    renderer.render(scene, camera);
}
```

- í”„ë ˆì„ë§ˆë‹¤ í”Œë ˆì´ì–´ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
- WebSocketìœ¼ë¡œ ìœ„ì¹˜ ì •ë³´ ì „ì†¡
- ì”¬ ë Œë”ë§

## 5. ë©€í‹°í”Œë ˆì´ì–´ ë™ê¸°í™”

### 5.1 ë‹¤ë¥¸ í”Œë ˆì´ì–´ ê´€ë¦¬
```JavaScript
let otherPlayers = {};

gameSocket.onmessage = (event) => {
    const data = JSON.parse(event.data);
    if (!otherPlayers[data.id]) {
        // ìƒˆë¡œìš´ í”Œë ˆì´ì–´ ìƒì„±
        const otherPlayer = new THREE.Mesh(/* ... */);
        otherPlayers[data.id] = otherPlayer;
    }
    // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
    otherPlayers[data.id].position.set(data.position.x, 0, data.position.z);
};
```

- ë‹¤ë¥¸ í”Œë ˆì´ì–´ë“¤ì˜ 3D ê°ì²´ ê´€ë¦¬
- ì‹¤ì‹œê°„ ìœ„ì¹˜ ë™ê¸°í™”

## 6. ë©”ì‹œì§€ í¬ë§·

### 6.1 ì±„íŒ… ë©”ì‹œì§€
```JavaScript
{
    sender: "ë‚˜",
    message: "ë©”ì‹œì§€ ë‚´ìš©",
    time: "ì‹œê°„ ì •ë³´"
}
```

### 6.2 ê²Œì„ ìœ„ì¹˜ ë°ì´í„°
```JavaScript
{
    id: "í”Œë ˆì´ì–´ID",
    position: {
        x: 0,
        z: 0
    }
}
```

## 7. ê°œì„  ê°€ëŠ¥í•œ ë¶€ë¶„

1. **ì„±ëŠ¥ ìµœì í™”**
   - ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ì£¼ê¸° ì¡°ì ˆ
   - ë Œë”ë§ ìµœì í™”
2. **ì—ëŸ¬ ì²˜ë¦¬**
   - WebSocket ì¬ì—°ê²° ë¡œì§
   - ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬
3. **ê²Œì„ ê¸°ëŠ¥**
   - ì¶©ëŒ ê°ì§€
   - í”Œë ˆì´ì–´ ìƒí˜¸ì‘ìš© ì¶”ê°€
4. **UI/UX**
   - í”Œë ˆì´ì–´ ì •ë³´ í‘œì‹œ
   - ê²Œì„ ìƒíƒœ í‘œì‹œ
5. **íŒŒì¼ êµ¬ì¡° ë¶„ë¦¬**

-----

# index.html íŒŒì¼ êµ¬ì¡° ë¶„ë¦¬ ì œì•ˆ
```Code
ğŸ“¦src
 â”£ ğŸ“‚assets
 â”ƒ â”— ğŸ“‚styles
 â”ƒ   â”— ğŸ“œmain.css
 â”£ ğŸ“‚js
 â”ƒ â”£ ğŸ“‚config
 â”ƒ â”ƒ â”£ ğŸ“œsocket.config.js
 â”ƒ â”ƒ â”— ğŸ“œthree.config.js
 â”ƒ â”£ ğŸ“‚core
 â”ƒ â”ƒ â”£ ğŸ“œScene.js
 â”ƒ â”ƒ â”£ ğŸ“œCamera.js
 â”ƒ â”ƒ â”— ğŸ“œRenderer.js
 â”ƒ â”£ ğŸ“‚objects
 â”ƒ â”ƒ â”£ ğŸ“œPlayer.js
 â”ƒ â”ƒ â”£ ğŸ“œFloor.js
 â”ƒ â”ƒ â”— ğŸ“œObjectManager.js
 â”ƒ â”£ ğŸ“‚services
 â”ƒ â”ƒ â”£ ğŸ“œChatService.js
 â”ƒ â”ƒ â”— ğŸ“œGameService.js
 â”ƒ â”£ ğŸ“‚utils
 â”ƒ â”ƒ â”£ ğŸ“œTimeFormatter.js
 â”ƒ â”ƒ â”— ğŸ“œEventEmitter.js
 â”ƒ â”— ğŸ“œmain.js
 â”£ ğŸ“œindex.html
 â”— ğŸ“œREADME.md
```

## 1. ì£¼ìš” íŒŒì¼ êµ¬ì¡° ì„¤ëª…

### index.html
```HTML
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Multiplayer Game</title>
    <link rel="stylesheet" href="assets/styles/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <div id="chatContainer">
        <div id="chatLog"></div>
        <input type="text" id="messageInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
        <button onclick="window.chatService.sendMessage()">ì „ì†¡</button>
    </div>
    <canvas id="threejs-canvas"></canvas>
    
    <script type="module" src="js/main.js"></script>
</body>
</html>
```

### main.css
```CSS
body {
    margin: 0;
    display: flex;
    flex-direction: column;
}

#chatContainer {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 100;
    /* ... */
}

#threejs-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
}
```

### config/socket.config.js
```JavaScript
export const SOCKET_CONFIG = {
    CHAT_ENDPOINT: 'ws://localhost:8080/chat',
    GAME_ENDPOINT: 'ws://localhost:8080/game'
};
```

### config/three.config.js
```JavaScript
export const THREE_CONFIG = {
    CAMERA: {
        FOV: 75,
        NEAR: 0.1,
        FAR: 1000,
        POSITION: { x: 0, y: 5, z: 10 }
    },
    COLORS: {
        PLAYER: 0x00ff00,
        OTHER_PLAYER: 0xff0000,
        FLOOR: 0x999999
    }
};
```

### core/Scene.js
```JavaScript
import { Scene } from 'three';

export class GameScene extends Scene {
    constructor() {
        super();
        this.initialize();
    }

    initialize() {
        // ì”¬ ì´ˆê¸°í™” ë¡œì§
    }
}
```

### objects/Player.js
```JavaScript
import { BoxGeometry, MeshBasicMaterial, Mesh } from 'three';
import { THREE_CONFIG } from '../config/three.config.js';

export class Player {
    constructor() {
        this.geometry = new BoxGeometry();
        this.material = new MeshBasicMaterial({ 
            color: THREE_CONFIG.COLORS.PLAYER 
        });
        this.mesh = new Mesh(this.geometry, this.material);
        this.speed = { x: 0, z: 0 };
    }

    update() {
        this.mesh.position.x += this.speed.x;
        this.mesh.position.z += this.speed.z;
    }
}
```

### services/ChatService.js
```JavaScript
import { SOCKET_CONFIG } from '../config/socket.config.js';
import { TimeFormatter } from '../utils/TimeFormatter.js';

export class ChatService {
    constructor() {
        this.socket = new WebSocket(SOCKET_CONFIG.CHAT_ENDPOINT);
        this.initialize();
    }

    initialize() {
        this.socket.onopen = this.handleOpen.bind(this);
        this.socket.onmessage = this.handleMessage.bind(this);
        this.socket.onclose = this.handleClose.bind(this);
        this.socket.onerror = this.handleError.bind(this);
    }

    sendMessage(message) {
        // ë©”ì‹œì§€ ì „ì†¡ ë¡œì§
    }

    // ... ê¸°íƒ€ ë©”ì„œë“œ
}
```

### services/GameService.js
```JavaScript
import { SOCKET_CONFIG } from '../config/socket.config.js';
import { ObjectManager } from '../objects/ObjectManager.js';

export class GameService {
    constructor(scene) {
        this.scene = scene;
        this.objectManager = new ObjectManager(scene);
        this.socket = new WebSocket(SOCKET_CONFIG.GAME_ENDPOINT);
        this.initialize();
    }

    initialize() {
        this.socket.onmessage = this.handleMessage.bind(this);
        // ... ê¸°íƒ€ ì´ˆê¸°í™”
    }

    updatePlayerPosition(position) {
        // ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ë¡œì§
    }
}
```

### main.js
```JavaScript
import { GameScene } from './core/Scene.js';
import { ChatService } from './services/ChatService.js';
import { GameService } from './services/GameService.js';
import { Player } from './objects/Player.js';

class Game {
    constructor() {
        this.scene = new GameScene();
        this.chatService = new ChatService();
        this.gameService = new GameService(this.scene);
        this.player = new Player();
        
        this.initialize();
    }

    initialize() {
        // ê²Œì„ ì´ˆê¸°í™”
        this.setupEventListeners();
        this.animate();
    }

    animate() {
        requestAnimationFrame(this.animate.bind(this));
        this.update();
        this.render();
    }

    // ... ê¸°íƒ€ ë©”ì„œë“œ
}

// ê²Œì„ ì‹œì‘
const game = new Game();
window.chatService = game.chatService; // ì±„íŒ… ì„œë¹„ìŠ¤ë¥¼ ì „ì—­ìœ¼ë¡œ ë…¸ì¶œ
```

## 2. ëª¨ë“ˆ ë¶„ë¦¬ì˜ ì¥ì 

1. **ì½”ë“œ êµ¬ì¡°í™”**
   - ê° ê¸°ëŠ¥ë³„ë¡œ ëª¨ë“ˆí™”ë˜ì–´ ê´€ë¦¬ê°€ ìš©ì´
   - ì˜ì¡´ì„± ëª…í™•íˆ íŒŒì•… ê°€ëŠ¥
2. **ì¬ì‚¬ìš©ì„±**
   - ëª¨ë“ˆë³„ë¡œ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥
   - ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œë„ ì¬ì‚¬ìš© ê°€ëŠ¥
3. **ìœ ì§€ë³´ìˆ˜**
   - ë²„ê·¸ ìˆ˜ì •ì´ ìš©ì´
   - ê¸°ëŠ¥ í™•ì¥ì´ ì‰¬ì›€
4. **í…ŒìŠ¤íŠ¸**
   - ëª¨ë“ˆë³„ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
   - í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± ìš©ì´

## 3. ì¶”ê°€ ê³ ë ¤ì‚¬í•­

1. **ë¹Œë“œ ë„êµ¬ ì„¤ì •**
   ```JSON
   {
     "scripts": {
       "dev": "vite",
       "build": "vite build",
       "preview": "vite preview"
     }
   }
   ```

2. **íƒ€ì… ì •ì˜**
   - TypeScript ë„ì… ê³ ë ¤
   - JSDoc ì£¼ì„ ì¶”ê°€

3. **í™˜ê²½ ì„¤ì •**
   ``` JavaScript
   // config/env.js
   export const ENV = {
       DEVELOPMENT: process.env.NODE_ENV === 'development',
       SOCKET_URL: process.env.SOCKET_URL || 'ws://localhost:8080'
   };
   ```

-----
